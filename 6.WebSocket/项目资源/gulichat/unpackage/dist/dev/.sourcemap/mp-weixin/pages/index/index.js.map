{"version":3,"sources":["webpack:///C:/Users/CHH/Desktop/11-4/硅谷聊天室/gulishop/pages/index/index.vue?f2da","webpack:///C:/Users/CHH/Desktop/11-4/硅谷聊天室/gulishop/pages/index/index.vue?43d8","webpack:///C:/Users/CHH/Desktop/11-4/硅谷聊天室/gulishop/main.js","webpack:///C:/Users/CHH/Desktop/11-4/硅谷聊天室/gulishop/pages/index/index.vue?ef1c","webpack:///C:/Users/CHH/Desktop/11-4/硅谷聊天室/gulishop/pages/index/index.vue?a960","webpack:///C:/Users/CHH/Desktop/11-4/硅谷聊天室/gulishop/pages/index/index.vue?66c6","webpack:///C:/Users/CHH/Desktop/11-4/硅谷聊天室/gulishop/pages/index/index.vue?fdad","webpack:///C:/Users/CHH/Desktop/11-4/硅谷聊天室/gulishop/pages/index/index.vue"],"names":["createPage","Page","dayTime","Date","toLocaleDateString","getTime","components","uniIcons","uniSwipeAction","uniSwipeActionItem","data","posRight","userId","uni","getStorageSync","messageList","userInfo","messageMapObj","onShow","onLoad","menuButtonInfo","getMenuButtonBoundingClientRect","width","$API","reqMessageList","forEach","item","index","chatType","userFace","filterFace","chatName","filterName","$set","chatToken","mapWebSocket","methods","closeSwipe","$refs","swipe","closeOther","toDetail","setStorageSync","navigateTo","url","unReadNumebr","SETCURRENTTOKENMUTATION","replace","nickName","avatarUrl","connectSocket","protocols","header","token","onSocketOpen","console","log","onSocketError","onSocketClose","onSocketMessage","info","JSON","parse","currentToken","$bus","$emit","ADDNEWMESSAGEMUTATION","message","lastModify","sendTime","lastText","msg","filters","timeFilter","date","format","computed"],"mappings":"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","file":"pages/index/index.js","sourcesContent":["import mod from \"-!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\lib\\\\loader.js??ref--8-oneOf-1-4!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&id=3808c730&lang=scss&scoped=true&\"; export default mod; export * from \"-!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\lib\\\\loader.js??ref--8-oneOf-1-4!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=style&index=0&id=3808c730&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin","import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'            \nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3808c730&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=3808c730&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3808c730\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('3808c730', component.options)\n    } else {\n      api.reload('3808c730', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=3808c730&scoped=true&\", function () {\n      api.rerender('3808c730', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"C:/Users/CHH/Desktop/11-4/硅谷聊天室/gulishop/pages/index/index.vue\"\nexport default component.exports","export * from \"-!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-hbuilderx\\\\packages\\\\webpack-uni-nvue-loader\\\\lib\\\\templateLoader.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=template&id=3808c730&scoped=true&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.messageList, function(item, __i0__) {\n    var f0 = _vm._f(\"timeFilter\")(item.lastModify)\n\n    return {\n      $orig: _vm.__get_orig(item),\n      f0: f0\n    }\n  })\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0\n      }\n    }\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./index.vue?vue&type=script&lang=js&\"","//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n\r\nimport {mapState,mapMutations} from 'vuex';\r\nimport moment from 'moment';\r\nimport uniIcons from '@/components/uni-icons/uni-icons.vue'\r\nimport uniSwipeAction from '@/components/uni-swipe-action/uni-swipe-action.vue'\r\nimport uniSwipeActionItem from '@/components/uni-swipe-action-item/uni-swipe-action-item.vue'\r\n\r\nlet dayTime=new Date(new Date(new Date().toLocaleDateString()).getTime());\r\nexport default{\r\n\tcomponents: { uniIcons,uniSwipeAction,uniSwipeActionItem },\r\n\tdata(){\r\n\t\treturn {\r\n\t\t\tposRight: '15px',\r\n\t\t\tuserId: uni.getStorageSync('userId') || '',\r\n\t\t\tmessageList:[],\r\n\t\t\tuserInfo:{},\r\n\t\t\tmessageMapObj:{}\r\n\t\t}\r\n\t},\r\n\tonShow(){\r\n\t},\r\n\tasync onLoad(){\r\n\r\n\t\tlet menuButtonInfo = uni.getMenuButtonBoundingClientRect()\r\n\t\tthis.posRight = (menuButtonInfo.width + 20) + 'px'\r\n\r\n\t\t\r\n\t\tthis.userInfo = uni.getStorageSync(\"userInfo\");\r\n\t\t\r\n\t\tlet messageList = await this.$API.reqMessageList();\r\n\t\t\r\n\t\tlet messageMapObj={};\r\n\t\tmessageList.forEach((item,index)=>{\r\n\t\t\tif(item.chatType === \"single\"){\r\n\t\t\t\titem.userFace = this.filterFace(item.userFace)\r\n\t\t\t\titem.chatName = this.filterName(item.chatName)\r\n\t\t\t}\r\n\t\t\tthis.$set(item,\"unReadNumebr\",0);\r\n\t\t\t\r\n\t\t\tmessageMapObj[item.chatToken]=index;\r\n\t\t})\r\n\t\t\r\n\t\tthis.messageMapObj = messageMapObj;\r\n\t\t\r\n\t\tthis.messageList = messageList;\r\n\t\t\r\n\t\tthis.mapWebSocket();\r\n\t},\r\n\tmethods: {\r\n\t\t// 关闭滑块\r\n\t\tcloseSwipe(){\r\n\t\t\tthis.$refs.swipe.closeOther()\r\n\t\t},\r\n\t\t// 详情\r\n\t\ttoDetail(item){\r\n\t\t\tuni.setStorageSync('chatInfo', item);\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl:\"/pages/groupChat/groupChat?chatToken=\"+item.chatToken\r\n\t\t\t})\r\n\t\t\titem.unReadNumebr = 0;\r\n\t\t\tthis.SETCURRENTTOKENMUTATION(item.chatToken);\r\n\t\t}\r\n\r\n\t\t\r\n\t\t\r\n\t\t,\r\n\t\tfilterName(chatName){\r\n\t\t\treturn chatName.replace(this.userInfo.nickName,\"\").replace(\"<->\",\"\");\r\n\t\t},\r\n\t\t\r\n\t\tfilterFace(userFace){\r\n\t\t\treturn userFace.replace(this.userInfo.avatarUrl,\"\").replace(\"<->\",\"\")\r\n\t\t},\r\n\t\tmapWebSocket(){\r\n\t\t\t\r\n\t\t\t\tuni.connectSocket({\r\n\t\t\t\t\turl:\"ws://localhost:3000\",\r\n\t\t\t\t\tprotocols:['echo-protocol'],\r\n\t\t\t\t\theader:{\r\n\t\t\t\t\t\ttoken:uni.getStorageSync(\"token\")\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tuni.onSocketOpen(function(){\r\n\t\t\t\t\tconsole.log('open success')\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tuni.onSocketError(function(){\r\n\t\t\t\t\tconsole.log('error success')\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tuni.onSocketClose(function(){\r\n\t\t\t\t\tconsole.log('close success')\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tuni.onSocketMessage(({data:info})=>{\r\n\t\t\t\t\tinfo = JSON.parse(info)\r\n\t\t\t\t\tif(this.currentToken === info.chatToken){\r\n\t\t\t\t\t\tthis.$bus.$emit('sendMsg',info.data)\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.ADDNEWMESSAGEMUTATION(info)\r\n\t\t\t\t\t\tconst index = this.messageMapObj[info.chatToken];\r\n\t\t\t\t\t\tconst message = this.messageList[index];\r\n\t\t\t\t\t\tmessage.lastModify = info.data.sendTime;\r\n\t\t\t\t\t\tmessage.userId = info.data.userId;\r\n\t\t\t\t\t\tmessage.lastText = info.data.msg;\r\n\t\t\t\t\t\tmessage.unReadNumebr += 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t},\r\n\t\t...mapMutations([\"ADDNEWMESSAGEMUTATION\",\"SETCURRENTTOKENMUTATION\",\"CLEARCURRENTTOKENMUTATION\"])\r\n\t},\r\n\tfilters:{\r\n\t\ttimeFilter(date){\r\n\t\t\tif(date-dayTime>0){\r\n\t\t\t\treturn moment(date).format(\"hh:mm\")\r\n\t\t\t}else{\r\n\t\t\t\treturn moment(date).format(\"YY/MM/DD\")\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomputed:{\r\n\t\t...mapState([\"currentToken\"])\r\n\t}\r\n}\r\n"],"sourceRoot":""}