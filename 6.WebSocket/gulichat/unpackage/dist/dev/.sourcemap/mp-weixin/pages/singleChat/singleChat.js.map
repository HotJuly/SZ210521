{"version":3,"sources":["webpack:///C:/Users/CHH/Desktop/SZ210521/6.WebSocket/gulichat/main.js","webpack:///C:/Users/CHH/Desktop/SZ210521/6.WebSocket/gulichat/pages/singleChat/singleChat.vue?73ee","webpack:///C:/Users/CHH/Desktop/SZ210521/6.WebSocket/gulichat/pages/singleChat/singleChat.vue?fb45","webpack:///C:/Users/CHH/Desktop/SZ210521/6.WebSocket/gulichat/pages/singleChat/singleChat.vue?ccf2","webpack:///C:/Users/CHH/Desktop/SZ210521/6.WebSocket/gulichat/pages/singleChat/singleChat.vue?0798","webpack:///C:/Users/CHH/Desktop/SZ210521/6.WebSocket/gulichat/pages/singleChat/singleChat.vue","webpack:///C:/Users/CHH/Desktop/SZ210521/6.WebSocket/gulichat/pages/singleChat/singleChat.vue?1dcb","webpack:///C:/Users/CHH/Desktop/SZ210521/6.WebSocket/gulichat/pages/singleChat/singleChat.vue?b381"],"names":["createPage","Page","data","emojis","isEdit","isFocus","scrollHeight","statusBarHeight","scrollViewId","voicePlayingId","content","list","socketOpen","socketMsgQueue","fromUserId","uni","getStorageSync","fromUserFace","toUserId","toUserName","onLoad","option","setScrollHeight","getSystemInfo","success","res","setNavigationBarTitle","title","onHide","methods","initScrollBar","setTimeout","inputFocus","e","detail","height","onKeyboardHeightChange","descHeight","send","pushMessage","type","cb","msgData","userFace","request","method","url","$api","addSingleMsg","header","$util","getHeader","code","toast","msgId","includes","staticPath","$xbcim","sendSingle","msgType","source","target","extra","id","push","togglePicker","getList","getSingleRecord","map","item","toUserFace"],"mappings":";;;;;;;;;;kDAAA,wCAAmB;;AAEnB;AACA,2G;AACAA,UAAU,CAACC,mBAAD,CAAV,C;;;;;;;;;;;;;ACJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqG;AACvC;AACL;AACsC;;;AAG/F;AACqI;AACrI,gBAAgB,kJAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,iGAAM;AACR,EAAE,0GAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACvCf;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACXA;AAAA;AAAA;AAAA;AAA4vB,CAAgB,uwBAAG,EAAC,C;;;;;;;;;;;;mICAhxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEc;AACbC,MADa,kBACP;AACL,WAAO;AACNC,YAAM,EAAE,EADF;AAENC,YAAM,EAAE,IAFF;AAGNC,aAAO,EAAE,KAHH;AAINC,kBAAY,EAAE,MAJR,EAIiB;AACvBC,qBAAe,EAAE,CALX,EAKe;AACrBC,kBAAY,EAAE,EANR,EAMa;AACnBC,oBAAc,EAAE,EAPV,EAOe;AACrBC,aAAO,EAAE,EARH;AASNC,UAAI,EAAE,EATA;AAUNC,gBAAU,EAAE,KAVN;AAWNC,oBAAc,EAAE,EAXV;AAYNC,gBAAU,EAAEC,GAAG,CAACC,cAAJ,CAAmB,QAAnB,CAZN;AAaNC,kBA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","file":"pages/singleChat/singleChat.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'            \nimport Page from './pages/singleChat/singleChat.vue'\ncreatePage(Page)","import { render, staticRenderFns } from \"./singleChat.vue?vue&type=template&id=a5ac62a6&scoped=true&\"\nimport script from \"./singleChat.vue?vue&type=script&lang=js&\"\nexport * from \"./singleChat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./singleChat.vue?vue&type=style&index=0&id=a5ac62a6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a5ac62a6\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('a5ac62a6', component.options)\n    } else {\n      api.reload('a5ac62a6', component.options)\n    }\n    module.hot.accept(\"./singleChat.vue?vue&type=template&id=a5ac62a6&scoped=true&\", function () {\n      api.rerender('a5ac62a6', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"C:/Users/CHH/Desktop/SZ210521/6.WebSocket/gulichat/pages/singleChat/singleChat.vue\"\nexport default component.exports","export * from \"-!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-hbuilderx\\\\packages\\\\webpack-uni-nvue-loader\\\\lib\\\\templateLoader.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./singleChat.vue?vue&type=template&id=a5ac62a6&scoped=true&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.content += _vm.item\n    }\n  }\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./singleChat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./singleChat.vue?vue&type=script&lang=js&\"","//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n\r\nexport default{\r\n\tdata(){\r\n\t\treturn {\r\n\t\t\temojis: [],\r\n\t\t\tisEdit: true,\r\n\t\t\tisFocus: false,\r\n\t\t\tscrollHeight: 'auto',\t\t// 内容区域高度\r\n\t\t\tstatusBarHeight: 0,\t\t// 状态栏高度\r\n\t\t\tscrollViewId: '',\t\t// 滚动到最底部\r\n\t\t\tvoicePlayingId: '',\t\t// 正在播放的消息ID\r\n\t\t\tcontent: '',\r\n\t\t\tlist: [],\r\n\t\t\tsocketOpen: false,\r\n\t\t\tsocketMsgQueue: [],\r\n\t\t\tfromUserId: uni.getStorageSync('userId'),\r\n\t\t\tfromUserFace: uni.getStorageSync('userFace'),\r\n\t\t\ttoUserId: '',\r\n\t\t\ttoUserName: '',\r\n\t\t}\r\n\t},\r\n\tonLoad(option){\r\n\t\t// 初始化内容高度\r\n\t\tthis.setScrollHeight()\r\n\t\t\r\n\t\t// 初始化状态栏高度\r\n\t\tuni.getSystemInfo({\r\n\t\t\tsuccess: res=>{\r\n\t\t\t\tthis.statusBarHeight = res.statusBarHeight\r\n\t\t\t}\r\n\t\t})\r\n\t\t\r\n\t\t// 设置标题\r\n\t\tuni.setNavigationBarTitle({ title: option.toUserName })\r\n\t\t\r\n\t\t// 获取参数\r\n\t\tthis.toUserId = option.toUserId\r\n\t\tthis.toUserName = option.toUserName\r\n\t\t\r\n\t\t\r\n\t},\r\n\tonHide(){\r\n\t},\r\n\tmethods: {\r\n\t\t// 初始化滚动\r\n\t\tinitScrollBar(){\r\n\t\t\tsetTimeout(()=>{\r\n\t\t\t\tthis.scrollViewId = ''\r\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\tthis.scrollViewId = 'bottom'\r\n\t\t\t\t\tsetTimeout(()=>{this.scrollViewId = ''}, 100)\r\n\t\t\t\t}, 100)\r\n\t\t\t}, 100)\r\n\t\t},\r\n\t\t// 监听输入聚焦\r\n\t\tinputFocus(e){\r\n\t\t\tthis.setScrollHeight(e.detail.height)\r\n\t\t\tthis.initScrollBar()\r\n\t\t\t\r\n\t\t\tuni.onKeyboardHeightChange(res=>{\r\n\t\t\t\tthis.setScrollHeight(res.height)\r\n\t\t\t\tthis.initScrollBar()\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 设置scroll的高度\r\n\t\tsetScrollHeight(descHeight=0){\r\n\r\n\t\t\tthis.scrollHeight = `calc(100vh - 110rpx - ${descHeight}px)`\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t},\r\n\r\n\t\t// 发送消息\r\n\t\tsend(){\r\n\t\t\tthis.pushMessage(this.content, 'text', ()=>{\r\n\t\t\t\tthis.content = ''\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 推送消息\r\n\t\tpushMessage(content, type='text', cb=()=>{}){\r\n\t\t\t// 组合消息体：需要保存在本地数据库的数据\r\n\t\t\tlet msgData = {\r\n\t\t\t\tfromUserId: this.fromUserId,\r\n\t\t\t\tuserFace: uni.getStorageSync('userFace'),\r\n\t\t\t\ttoUserId: this.toUserId,\r\n\t\t\t\ttype,\r\n\t\t\t\tcontent\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 本地保存\r\n\t\t\tuni.request({\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\turl: this.$api.addSingleMsg,\r\n\t\t\t\tdata: msgData,\r\n\t\t\t\theader: this.$util.getHeader(),\r\n\t\t\t\tsuccess: res=>{\r\n\t\t\t\t\tif(res.data.code){\r\n\t\t\t\t\t\treturn this.$util.toast(res.data.code)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet msgId = res.data.data\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 判断是否为非文本\r\n\t\t\t\t\tif(!['text', 'map'].includes(type)){\r\n\t\t\t\t\t\tmsgData.content = this.$api.staticPath + msgData.content\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 发送单聊消息\r\n\t\t\t\t\tthis.$xbcim.sendSingle({\r\n\t\t\t\t\t\tcontent: msgData.content,\r\n\t\t\t\t\t\tmsgType: type,\r\n\t\t\t\t\t\tsource: this.fromUserId,\r\n\t\t\t\t\t\ttarget: this.toUserId,\r\n\t\t\t\t\t\textra: {\r\n\t\t\t\t\t\t\tid: msgId,\r\n\t\t\t\t\t\t\tuserFace: uni.getStorageSync('userFace')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 加入信息\r\n\t\t\t\t\tthis.list.push({\r\n\t\t\t\t\t\tsource: this.fromUserId,\r\n\t\t\t\t\t\ttarget: this.toUserId,\r\n\t\t\t\t\t\tcontent: msgData.content,\r\n\t\t\t\t\t\tuserFace: uni.getStorageSync('userFace'),\r\n\t\t\t\t\t\ttype: 'single',\r\n\t\t\t\t\t\tmsgType: type\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 初始化滚动条\r\n\t\t\t\t\tthis.initScrollBar()\r\n\t\t\t\t\tcb ? cb() : this.togglePicker(0, 'file')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 获取记录\r\n\t\tgetList(){\r\n\t\t\tuni.request({\r\n\t\t\t\turl: this.$api.getSingleRecord,\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tfromUserId: this.fromUserId,\r\n\t\t\t\t\ttoUserId: this.toUserId\r\n\t\t\t\t},\r\n\t\t\t\theader: this.$util.getHeader(),\r\n\t\t\t\tsuccess: res=>{\r\n\t\t\t\t\tthis.list = res.data.data.map(item=>{\r\n\t\t\t\t\t\tif(['voice', 'image'].includes(item.type)){\r\n\t\t\t\t\t\t\titem.content = this.$api.staticPath+item.content\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(item.toUserFace){\r\n\t\t\t\t\t\t\titem.toUserFace = this.$api.staticPath+item.toUserFace\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 为了和socket的字段一致，此处做一个转换；\r\n\t\t\t\t\t\t// 数据表字段可以直接设置为source、target和msgType\r\n\t\t\t\t\t\titem.source = item.fromUserId\r\n\t\t\t\t\t\titem.target = item.toUserId\r\n\t\t\t\t\t\titem.msgType = item.type\r\n\t\t\t\t\t\treturn item\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.scrollViewId = ''\r\n\t\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\t\tthis.scrollViewId = 'bottom'\r\n\t\t\t\t\t\tsetTimeout(()=>{this.scrollViewId = ''}, 100)\r\n\t\t\t\t\t}, 100)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n","import mod from \"-!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\lib\\\\loader.js??ref--8-oneOf-1-4!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./singleChat.vue?vue&type=style&index=0&id=a5ac62a6&lang=scss&scoped=true&\"; export default mod; export * from \"-!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\index.js??ref--8-oneOf-1-2!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\lib\\\\loader.js??ref--8-oneOf-1-4!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\devtool\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./singleChat.vue?vue&type=style&index=0&id=a5ac62a6&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}